<!-- This file is generated by the Azure API Management Policy Toolkit -->
<!-- Version: 0.0.1.0 -->
<policies>
  <inbound>
    <base />
    <choose>
      <when condition="@(context.Request.IpAddress.StartsWith("10.0.0."))">
        <authentication-basic username="username" password="password" />
      </when>
      <otherwise>
        <authentication-managed-identity resource="https://graph.microsoft.com" />
      </otherwise>
    </choose>
    <set-header name="X-User-Id" exists-action="override">
      <value>@(context.User.Id)</value>
    </set-header>
  </inbound>
</policies>